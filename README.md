# 即时录屏软件

一款简单易用的Windows即时录屏软件，支持区域/窗口录制、系统声音和麦克风同步录制，提供全局快捷键操作。

## 功能特点

- 选择区域录制或窗口录制
- 录制系统声音和/或麦克风
- 全局快捷键控制（开始/停止录制、退出应用）
- 录制前自动检测设备可用性
- 对常见录制问题提供解决方案
- 自定义输出路径

## 系统要求

- Windows 10操作系统
- Python 3.8+
- 安装所有依赖项（见requirements.txt）

## 安装

1. 克隆或下载本仓库

2. 创建虚拟环境（推荐）:
   ```
   python -m venv .venv
   .venv\Scripts\activate
   ```

3. 安装依赖:
   ```
   pip install -r requirements.txt
   ```

## 使用方法

1. 运行主程序:
   ```
   python src/main.py
   ```

2. 选择录制类型（区域或窗口）
3. 选择是否录制系统声音和/或麦克风
4. 设置输出路径
5. 点击"开始录制"按钮或使用快捷键Ctrl+Alt+R
6. 选择要录制的区域或窗口
7. 录制完成后，点击"停止录制"按钮或再次使用快捷键Ctrl+Alt+R

## 快捷键

- `Ctrl+Alt+R`: 开始/停止录制
- `Ctrl+Alt+Q`: 退出应用

## 常见问题解决

### 无法录制系统声音

如果在使用过程中遇到无法录制系统声音的问题，请尝试以下解决方法：

1. **启用"立体声混音"设备**：
   - 右键点击Windows任务栏上的扬声器图标，选择"声音设置"
   - 在声音设置中，点击"声音控制面板"
   - 在弹出的窗口中，切换到"录制"选项卡
   - 右键点击空白区域，确保勾选了"显示禁用的设备"和"显示断开连接的设备"
   - 找到"立体声混音"（可能也叫"Stereo Mix"、"What U Hear"或其他名称，取决于声卡）
   - 右键点击该设备，选择"启用"，然后将其设为默认设备

2. **更新声卡驱动**：
   - 访问设备制造商的官方网站下载最新驱动
   - 有时官方驱动比Windows自带驱动提供更多功能，包括立体声混音功能

3. **使用虚拟音频设备（最可靠的解决方案）**：
   - 安装虚拟音频设备如VB-Cable（https://vb-audio.com/Cable/）
   - 配置方法：
     1. 下载并安装VB-Cable
     2. 在声音设置中将系统默认输出设置为"CABLE Input"
     3. 在录屏软件中选择"CABLE Output"作为录音输入源
   - 优点：几乎适用于任何声卡和系统配置

4. **检查隐私设置**：
   - 在Windows设置中，进入"隐私">"麦克风"
   - 确保已允许应用访问麦克风

5. **常见错误和解决方案**：
   - `_Speaker object has no attribute 'recorder'`：这表示您的声卡可能不支持系统声音回路录制，请使用上述第3项方案
   - 录制的文件中没有声音：请确保系统未静音，并且在录制时有声音输出
   - 应用崩溃：请确保已安装所有必要的依赖库，并且声卡驱动是最新的

如果您无法通过上述方法解决问题，可以尝试使用OBS Studio等专业录屏软件，它们通常有自己的系统声音捕获机制。

## 开发者信息

本应用使用Python开发，主要依赖以下库：
- mss：屏幕捕捉
- pywin32：窗口操作
- keyboard：全局热键支持
- soundcard：音频录制
- opencv-python：视频处理
- moviepy：音视频合并

## 许可证

[MIT](LICENSE)

## 打包应用

```
pyinstaller --onefile --windowed --icon=assets/icon.ico src/main.py
``` 